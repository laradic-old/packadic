define(["jquery","../../../node_modules/jquery-ui/widget","../../tpls/side-nav"],function(e){function t(e){return typeof e!="undefined"}function n(){var e=document.createElement("mm"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(e.style[n]!==undefined)return{end:t[n]};return!1}e.fn.emulateTransitionEnd=function(t){var n=!1,i=this;e(this).one("mmTransitionEnd",function(){n=!0});var s=function(){n||e(i).trigger(r.end)};return setTimeout(s,t),this};var r=n();!r||(e.event.special.mmTransitionEnd={bindType:r.end,delegateType:r.end,handle:function(t){if(e(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}}),e.widget("packadic.sideNav",{version:"1.0.0",options:{toggle:!0,doubleTapToGo:!1,transitionDuration:350},_create:function(){var t=this;console.log("init sidemenu",this),this.transitioning=null;var n=t.element.data("sidemenu");t.options=_.merge(t.options,n),n||t.element.data("mm",n=t),t.$body=e("body"),t.$navToggle=e("#side-nav-toggle"),t.element.find("li").has("ul").children("a").on("click."+t.widgetName,function(n){var r=e(this),i=r.parent("li"),s=i.children("ul");n.preventDefault(),i.hasClass("active")?t.hide(s):t.show(s),i.siblings(".active").removeClass("active")}),t.element.find("li.active").parents("ul").each(function(){var t=e(this),n=t.parent("li");!n.hasClass("active"),t.addClass("collapse in")}),t.element.find("li").not(".active").has("ul").children("ul").addClass("collapse"),t.element.find("li.active").has("ul").children("ul").addClass("collapse in"),t.$navToggle.on("click",function(e){e.preventDefault(),t.toggle()})},_destroy:function(){this.element.off("."+this.widgetName),this.element.removeData(this.widgetName)},close:function(){if(this.isClosed())return;this.$body.addClass("sidebar-closed")},open:function(){this.$body.removeClass("sidebar-closed")},toggle:function(){this.isClosed()?this.open():this.close()},isClosed:function(){return this.$body.hasClass("sidebar-closed")},show:function(t){var n=t.parent("li");if(this.transitioning||t.hasClass("in"))return;n.addClass("active"),this.options.toggle&&this.hide(n.siblings().children("ul.in")),t.removeClass("collapse").addClass("collapsing").height(0),this.transitioning=1;var i=function(){t.removeClass("collapsing").addClass("collapse in").height(""),this.transitioning=0}.bind(this);if(!r)return i();t.one("mmTransitionEnd",e.proxy(i,this)).emulateTransitionEnd(this.options.transitionDuration).height(t[0].scrollHeight)},hide:function(t){if(this.transitioning||!t.hasClass("in"))return;t.parent("li").removeClass("active"),t.height(t.height())[0].offsetHeight,t.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var n=function(){this.transitioning=0,t.removeClass("collapsing").addClass("collapse")}.bind(this);if(!r)return n();t.height(0).one("mmTransitionEnd",e.proxy(n,this)).emulateTransitionEnd(this.options.transitionDuration)},createFromJSON:function(e){this._destroy();var t=Packadic.getTemplate("side-nav",{items:e,location:window.location});this.element.html("").html(t),this._create()}})});