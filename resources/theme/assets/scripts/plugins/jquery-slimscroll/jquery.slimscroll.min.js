(function(e){e.fn.extend({slimScroll:function(n){var r=e.extend({width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:.2,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:20,touchScrollStep:200,borderRadius:"7px",railBorderRadius:"7px"},n);return this.each(function(){function i(t){if(c){t=t||window.event;var n=0;t.wheelDelta&&(n=-t.wheelDelta/120),t.detail&&(n=t.detail/3),e(t.target||t.srcTarget||t.srcElement).closest("."+r.wrapperClass).is(E.parent())&&s(n,!0),t.preventDefault&&!w&&t.preventDefault(),w||(t.returnValue=!1)}}function s(e,t,n){w=!1;var i=e,s=E.outerHeight()-x.outerHeight();t&&(i=parseInt(x.css("top"))+e*parseInt(r.wheelStep)/100*x.outerHeight(),i=Math.min(Math.max(i,0),s),i=0<e?Math.ceil(i):Math.floor(i),x.css({top:i+"px"})),y=parseInt(x.css("top"))/(E.outerHeight()-x.outerHeight()),i=y*(E[0].scrollHeight-E.outerHeight()),n&&(i=e,e=i/E[0].scrollHeight*E.outerHeight(),e=Math.min(Math.max(e,0),s),x.css({top:e+"px"})),E.scrollTop(i),E.trigger("slimscrolling",~~i),f(),l()}function o(){window.addEventListener?(this.addEventListener("DOMMouseScroll",i,!1),this.addEventListener("mousewheel",i,!1)):document.attachEvent("onmousewheel",i)}function u(){m=Math.max(E.outerHeight()/E[0].scrollHeight*E.outerHeight(),30),x.css({height:m+"px"});var e=m==E.outerHeight()?"none":"block";x.css({display:e})}function f(){u(),clearTimeout(d),y==~~y?(w=r.allowPageScroll,b!=y&&E.trigger("slimscroll",0==~~y?"top":"bottom")):w=!1,b=y,m>=E.outerHeight()?w=!0:(x.stop(!0,!0).fadeIn("fast"),r.railVisible&&T.stop(!0,!0).fadeIn("fast"))}function l(){r.alwaysVisible||(d=setTimeout(function(){r.disableFadeOut&&c||h||p||(x.fadeOut("slow"),T.fadeOut("slow"))},1e3))}var c,h,p,d,v,m,y,b,w=!1,E=e(this);if(E.parent().hasClass(r.wrapperClass)){var S=E.scrollTop(),x=E.parent().find("."+r.barClass),T=E.parent().find("."+r.railClass);u();if(e.isPlainObject(n)){if("height"in n&&"auto"==n.height){E.parent().css("height","auto"),E.css("height","auto");var N=E.parent().parent().height();E.parent().css("height",N),E.css("height",N)}if("scrollTo"in n)S=parseInt(r.scrollTo);else if("scrollBy"in n)S+=parseInt(r.scrollBy);else if("destroy"in n){x.remove(),T.remove(),E.unwrap();return}s(S,!1,!0)}}else if(!(e.isPlainObject(n)&&"destroy"in n)){r.height="auto"==r.height?E.parent().height():r.height,S=e("<div></div>").addClass(r.wrapperClass).css({position:"relative",overflow:"hidden",width:r.width,height:r.height}),E.css({overflow:"hidden",width:r.width,height:r.height});var T=e("<div></div>").addClass(r.railClass).css({width:r.size,height:"100%",position:"absolute",top:0,display:r.alwaysVisible&&r.railVisible?"block":"none","border-radius":r.railBorderRadius,background:r.railColor,opacity:r.railOpacity,zIndex:90}),x=e("<div></div>").addClass(r.barClass).css({background:r.color,width:r.size,position:"absolute",top:0,opacity:r.opacity,display:r.alwaysVisible?"block":"none","border-radius":r.borderRadius,BorderRadius:r.borderRadius,MozBorderRadius:r.borderRadius,WebkitBorderRadius:r.borderRadius,zIndex:99}),N="right"==r.position?{right:r.distance}:{left:r.distance};T.css(N),x.css(N),E.wrap(S),E.parent().append(x),E.parent().append(T),r.railDraggable&&x.bind("mousedown",function(n){var r=e(document);return p=!0,t=parseFloat(x.css("top")),pageY=n.pageY,r.bind("mousemove.slimscroll",function(e){currTop=t+e.pageY-pageY,x.css("top",currTop),s(0,x.position().top,!1)}),r.bind("mouseup.slimscroll",function(e){p=!1,l(),r.unbind(".slimscroll")}),!1}).bind("selectstart.slimscroll",function(e){return e.stopPropagation(),e.preventDefault(),!1}),T.hover(function(){f()},function(){l()}),x.hover(function(){h=!0},function(){h=!1}),E.hover(function(){c=!0,f(),l()},function(){c=!1,l()}),E.bind("touchstart",function(e,t){e.originalEvent.touches.length&&(v=e.originalEvent.touches[0].pageY)}),E.bind("touchmove",function(e){w||e.originalEvent.preventDefault(),e.originalEvent.touches.length&&(s((v-e.originalEvent.touches[0].pageY)/r.touchScrollStep,!0),v=e.originalEvent.touches[0].pageY)}),u(),"bottom"===r.start?(x.css({top:E.outerHeight()-x.outerHeight()}),s(0,!0)):"top"!==r.start&&(s(e(r.start).position().top,null,!0),r.alwaysVisible||x.hide()),o()}}),this}}),e.fn.extend({slimscroll:e.fn.slimScroll})})(jQuery);