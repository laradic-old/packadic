(function(e,t){var n=typeof t.FileReader!="undefined",r=function(t){var n=e.split((t.valAttr("allowing")||"").toLowerCase());return e.inArray("jpg",n)>-1&&e.inArray("jpeg",n)==-1?n.push("jpeg"):e.inArray("jpeg",n)>-1&&e.inArray("jpg",n)==-1&&n.push("jpg"),n},i=function(e,t,n,r){var i=r[t]||"";e.errorMessageKey="",e.errorMessage=i.replace("%s",n)},s=function(e){t.console&&t.console.log&&t.console.log(e)};e.formUtils.addValidator({name:"mime",validatorFunction:function(t,o,u,a){if(n){var f=!0,l=o.get(0).files||[],c="",h=r(o);return l.length&&(e.each(l,function(t,n){return f=!1,c=n.type||"",e.each(h,function(e,t){f=c.indexOf(t)>-1;if(f)return!1}),f}),f||(s("Trying to upload a file with mime type "+c+" which is not allowed"),i(this,"wrongFileType",h.join(", "),a))),f}return s("FileReader not supported by browser, will check file extension"),e.formUtils.validators.validate_extension.validatorFunction(t,o,u,a)},errorMessage:"",errorMessageKey:"wrongFileType"}),e.formUtils.addValidator({name:"extension",validatorFunction:function(t,n,s,o){var u=!0,a=this,f=r(n);return e.each(n.get(0).files||[t],function(t,n){var r=typeof n=="string"?n:n.value||n.fileName||n.name,s=r.substr(r.lastIndexOf(".")+1);if(e.inArray(s.toLowerCase(),f)==-1)return u=!1,i(a,"wrongFileType",f.join(", "),o),!1}),u},errorMessage:"",errorMessageKey:"wrongFileType"}),e.formUtils.addValidator({name:"size",validatorFunction:function(t,r,o,u){var a=r.valAttr("max-size");if(!a)return s('Input "'+r.attr("name")+'" is missing data-validation-max-size attribute'),!0;if(!n)return!0;var f=e.formUtils.convertSizeNameToBytes(a),l=!0;return e.each(r.get(0).files||[],function(e,t){return l=t.size<=f,l}),l||i(this,"wrongFileSize",a,u),l},errorMessage:"",errorMessageKey:"wrongFileSize"}),e.formUtils.convertSizeNameToBytes=function(e){return e=e.toUpperCase(),e.substr(e.length-1,1)=="M"?parseInt(e.substr(0,e.length-1),10)*1024*1024:e.substr(e.length-2,2)=="MB"?parseInt(e.substr(0,e.length-2),10)*1024*1024:e.substr(e.length-2,2)=="KB"?parseInt(e.substr(0,e.length-2),10)*1024:e.substr(e.length-1,1)=="B"?parseInt(e.substr(0,e.length-1),10):parseInt(e,10)},e(t).one("validatorsLoaded formValidationSetup",function(t,n){var r;n?r=n.find('input[type="file"]'):r=e('input[type="file"]'),r.filter("*[data-validation]").bind("change",function(){e(this).removeClass("error").parent().find(".form-error").remove()})})})(jQuery,window);