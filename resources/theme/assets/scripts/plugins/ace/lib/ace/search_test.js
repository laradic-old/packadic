typeof process!="undefined"&&require("amd-loader"),define(["require","exports","module","./edit_session","./test/mockrenderer","./editor","./search","./test/assertions"],function(e,t,n){var r=e("./edit_session").EditSession,i=e("./test/mockrenderer").MockRenderer,s=e("./editor").Editor,o=e("./search").Search,u=e("./test/assertions");n.exports={"test: configure the search object":function(){var e=new o;e.set({needle:"juhu"})},"test: find simple text in document":function(){var e=new r(["juhu kinners 123","456"]),t=(new o).set({needle:"kinners"}),n=t.find(e);u.position(n.start,0,5),u.position(n.end,0,12)},"test: find simple text in next line":function(){var e=new r(["abc","juhu kinners 123","456"]),t=(new o).set({needle:"kinners"}),n=t.find(e);u.position(n.start,1,5),u.position(n.end,1,12)},"test: find text starting at cursor position":function(){var e=new r(["juhu kinners","juhu kinners 123"]);e.getSelection().moveCursorTo(0,6);var t=(new o).set({needle:"kinners"}),n=t.find(e);u.position(n.start,1,5),u.position(n.end,1,12)},"test: wrap search is on by default":function(){var e=new r(["abc","juhu kinners 123","456"]);e.getSelection().moveCursorTo(2,1);var t=(new o).set({needle:"kinners"});u.notEqual(t.find(e),null)},"test: wrap search should wrap at file end":function(){var e=new r(["abc","juhu kinners 123","456"]);e.getSelection().moveCursorTo(2,1);var t=(new o).set({needle:"kinners",wrap:!0}),n=t.find(e);u.position(n.start,1,5),u.position(n.end,1,12)},"test: wrap search should find needle even if it starts inside it":function(){var e=new r(["abc","juhu kinners 123","456"]);e.getSelection().moveCursorTo(6,1);var t=(new o).set({needle:"kinners",wrap:!0}),n=t.find(e);u.position(n.start,1,5),u.position(n.end,1,12)},"test: wrap search with no match should return 'null'":function(){var e=new r(["abc","juhu kinners 123","456"]);e.getSelection().moveCursorTo(2,1);var t=(new o).set({needle:"xyz",wrap:!0});u.equal(t.find(e),null)},"test: case sensitive is by default off":function(){var e=new r(["abc","juhu kinners 123","456"]),t=(new o).set({needle:"JUHU"});u.range(t.find(e),1,0,1,4)},"test: case sensitive search":function(){var e=new r(["abc","juhu kinners 123","456"]),t=(new o).set({needle:"KINNERS",caseSensitive:!0}),n=t.find(e);u.equal(n,null)},"test: whole word search should not match inside of words":function(){var e=new r(["juhukinners","juhu kinners 123","456"]),t=(new o).set({needle:"kinners",wholeWord:!0}),n=t.find(e);u.position(n.start,1,5),u.position(n.end,1,12)},"test: find backwards":function(){var e=new r(["juhu juhu juhu juhu"]);e.getSelection().moveCursorTo(0,10);var t=(new o).set({needle:"juhu",backwards:!0}),n=t.find(e);u.position(n.start,0,5),u.position(n.end,0,9)},"test: find in selection":function(){var e=new r(["juhu","juhu","juhu","juhu"]);e.getSelection().setSelectionAnchor(1,0),e.getSelection().selectTo(3,5);var t=(new o).set({needle:"juhu",wrap:!0,range:e.getSelection().getRange()}),n=t.find(e);u.position(n.start,1,0),u.position(n.end,1,4),t=(new o).set({needle:"juhu",wrap:!0,range:e.getSelection().getRange()}),e.getSelection().setSelectionAnchor(0,2),e.getSelection().selectTo(3,2);var n=t.find(e);u.position(n.start,1,0),u.position(n.end,1,4)},"test: find backwards in selection":function(){var e=new r(["juhu","juhu","juhu","juhu"]);e.getSelection().setSelectionAnchor(0,2),e.getSelection().selectTo(3,2);var t=(new o).set({needle:"juhu",wrap:!0,backwards:!0,range:e.getSelection().getRange()}),n=t.find(e);u.position(n.start,2,0),u.position(n.end,2,4),t=(new o).set({needle:"juhu",wrap:!0,range:e.getSelection().getRange()}),e.getSelection().setSelectionAnchor(0,2),e.getSelection().selectTo(1,2);var n=t.find(e);u.position(n.start,1,0),u.position(n.end,1,4)},"test: edge case - match directly before the cursor":function(){var e=new r(["123","123","juhu"]),t=(new o).set({needle:"juhu",wrap:!0});e.getSelection().moveCursorTo(2,5);var n=t.find(e);u.position(n.start,2,0),u.position(n.end,2,4)},"test: edge case - match backwards directly after the cursor":function(){var e=new r(["123","123","juhu"]),t=(new o).set({needle:"juhu",wrap:!0,backwards:!0});e.getSelection().moveCursorTo(2,0);var n=t.find(e);u.position(n.start,2,0),u.position(n.end,2,4)},"test: find using a regular expression":function(){var e=new r(["abc123 123 cd","abc"]),t=(new o).set({needle:"\\d+",regExp:!0}),n=t.find(e);u.position(n.start,0,3),u.position(n.end,0,6)},"test: find using a regular expression and whole word":function(){var e=new r(["abc123 123 cd","abc"]),t=(new o).set({needle:"\\d+\\b",regExp:!0,wholeWord:!0}),n=t.find(e);u.position(n.start,0,7),u.position(n.end,0,10)},"test: use regular expressions with capture groups":function(){var e=new r(["  ab: 12px","  <h1 abc"]),t=(new o).set({needle:"(\\d+)",regExp:!0}),n=t.find(e);u.position(n.start,0,6),u.position(n.end,0,8)},"test: find all matches in selection":function(){var e=new r(["juhu","juhu","juhu","juhu"]);e.getSelection().setSelectionAnchor(0,2),e.getSelection().selectTo(3,2);var t=(new o).set({needle:"uh",wrap:!0,range:e.getSelection().getRange()}),n=t.findAll(e);u.equal(n.length,2),u.position(n[0].start,1,1),u.position(n[0].end,1,3),u.position(n[1].start,2,1),u.position(n[1].end,2,3)},"test: find all multiline matches":function(){var e=new r(["juhu","juhu","juhu","juhu"]),t=(new o).set({needle:"hu\nju",wrap:!0}),n=t.findAll(e);u.equal(n.length,3),u.position(n[0].start,0,2),u.position(n[0].end,1,2),u.position(n[1].start,1,2),u.position(n[1].end,2,2)},"test: replace() should return the replacement if the input matches the needle":function(){var e=(new o).set({needle:"juhu"});u.equal(e.replace("juhu","kinners"),"kinners"),u.equal(e.replace("","kinners"),null),u.equal(e.replace(" juhu","kinners"),null),u.equal(e.replace("Juhu","kinners"),"kinners"),e.set({caseSensitive:!0}),u.equal(e.replace("Juhu","kinners"),null)},"test: replace with a RegExp search":function(){var e=(new o).set({needle:"\\d+",regExp:!0});u.equal(e.replace("123","kinners"),"kinners"),u.equal(e.replace("01234","kinners"),"kinners"),u.equal(e.replace("","kinners"),null),u.equal(e.replace("a12","kinners"),null),u.equal(e.replace("12a","kinners"),null)},"test: replace with RegExp match and capture groups":function(){var e=(new o).set({needle:"ab(\\d\\d)",regExp:!0});u.equal(e.replace("ab12","cd$1"),"cd12"),u.equal(e.replace("ab12","-$&-"),"-ab12-"),u.equal(e.replace("ab12","$$"),"$")},"test: find all using regular expresion containing $":function(){var e=new r(["a","     b","c ","d"]),t=(new o).set({needle:"[ ]+$",regExp:!0,wrap:!0});e.getSelection().moveCursorTo(1,2);var n=t.findAll(e);u.equal(n.length,1),u.position(n[0].start,2,1),u.position(n[0].end,2,2)},"test: find all matches in a line":function(){var e=new r("foo bar foo baz foobar foo"),t=(new o).set({needle:"foo",wrap:!0,wholeWord:!0});e.getSelection().moveCursorTo(0,4);var n=t.findAll(e);u.equal(n.length,3),u.position(n[0].start,0,0),u.position(n[0].end,0,3),u.position(n[1].start,0,8),u.position(n[1].end,0,11),u.position(n[2].start,0,23),u.position(n[2].end,0,26)},"test: find all matches in a line backwards":function(){var e=new r("foo bar foo baz foobar foo"),t=(new o).set({needle:"foo",wrap:!0,wholeWord:!0,backwards:!0});e.getSelection().moveCursorTo(0,13);var n=t.findAll(e);u.equal(n.length,3),u.position(n[2].start,0,23),u.position(n[2].end,0,26),u.position(n[1].start,0,8),u.position(n[1].end,0,11),u.position(n[0].start,0,0),u.position(n[0].end,0,3)},"test: find next empty range":function(){var e=new r("foo foobar foo"),t=new s(new i,e),n={needle:"o*",wrap:!0,regExp:!0,backwards:!1},o=[4,5.2,7,8,9,10,11,12.2,14,0,1.2,3];e.selection.moveCursorTo(0,3);for(var a=0;a<12;a++){t.find(n);var f=t.selection.getRange(),l=f.start.column,c=f.end.column-l;u.equal(l+.1*c,o[a])}n.backwards=!0,o=[1.2,1,0,14,12.2,12,11,10,9,8,7,5.2,5,4,3];for(var a=0;a<16;a++){t.find(n);var f=t.selection.getRange(),l=f.start.column,c=f.end.column-l;console.log(l+.1*c)}}}}),typeof module!="undefined"&&module===require.main&&require("asyncjs").test.testcase(module.exports).exec();