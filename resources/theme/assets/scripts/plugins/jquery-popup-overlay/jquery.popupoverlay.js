(function(e){var t=e(window),n={},r=[],i=[],s=!1,o=!1,u,a=null,f=null,l=null,c=null,h="_open",p="_close",d=null,v={_init:function(t){var n=e(t),s=n.data("popupoptions");i[t.id]=!1,r[t.id]=0,n.data("popup-initialized")||(n.attr("data-popup-initialized","true"),v._initonce(t)),s.autoopen&&setTimeout(function(){v.show(t,0)},0)},_initonce:function(t){var n=e("body"),r,i=$el.data("popupoptions");c=parseInt(n.css("margin-right"),10),i.type=="tooltip"&&(i.background=!1,i.scrolllock=!1);if(i.scrolllock){var s,o;typeof u=="undefined"&&(s=e('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),o=s.children(),u=o.innerWidth()-o.height(99).innerWidth(),s.remove())}$el.attr("id")||$el.attr("id","j-popup-"+parseInt(Math.random()*1e8)),$el.addClass("popup_content"),n.prepend(t),$el.wrap('<div id="'+t.id+'_wrapper" class="popup_wrapper" />'),r=e("#"+t.id+"_wrapper"),r.css({opacity:0,visibility:"hidden",position:"absolute",overflow:"auto"}),$el.css({opacity:0,visibility:"hidden",display:"inline-block"}),i.setzindex&&!i.autozindex&&r.css("z-index","2001"),i.outline||$el.css("outline","none"),i.transition&&($el.css("transition",i.transition),r.css("transition",i.transition)),e(t).attr("aria-hidden",!0);if(i.background&&!e("#"+t.id+"_background").length){var a='<div id="'+t.id+'_background" class="popup_background"></div>';n.prepend(a);var f=e("#"+t.id+"_background");f.css({opacity:0,visibility:"hidden",backgroundColor:i.color,position:"fixed",top:0,right:0,bottom:0,left:0}),i.setzindex&&!i.autozindex&&f.css("z-index","2000"),i.transition&&f.css("transition",i.transition)}i.type=="overlay"&&($el.css({textAlign:"left",position:"relative",verticalAlign:"middle"}),r.css({position:"fixed",top:0,right:0,left:0,bottom:0,textAlign:"center"}),r.append('<div class="popup_align" />'),e(".popup_align").css({display:"inline-block",verticalAlign:"middle",height:"100%"})),$el.attr("role","dialog");var l=i.openelement?i.openelement:"."+t.id+h;e(l).each(function(t,n){e(n).attr("data-popup-ordinal",t),e(n).attr("id")||e(n).attr("id","open_"+parseInt(Math.random()*1e8,10))}),!$el.attr("aria-labelledby")&&!$el.attr("aria-label")&&$el.attr("aria-labelledby",e(l).attr("id")),e(document).on("click",l,function(n){if(!$el.data("popup-visible")){var r=e(this).data("popup-ordinal");setTimeout(function(){v.show(t,r)},0),n.preventDefault()}});var d=i.closeelement?i.closeelement:"."+t.id+p;e(document).on("click",d,function(e){v.hide(t),e.preventDefault()}),i.detach?$el.hide().detach():r.hide()},show:function(n,h){var p=e(n);if(p.data("popup-visible"))return;p.data("popup-initialized")||v._init(n),p.attr("data-popup-initialized","true");var g=e("body"),y=p.data("popupoptions"),b=e("#"+n.id+"_wrapper"),w=e("#"+n.id+"_background");m(n,h,y.beforeopen),i[n.id]=h,y.detach?(b.prepend(n),p.show()):b.show(),setTimeout(function(){b.css({visibility:"visible",opacity:1}),e("html").addClass("popup_visible").addClass("popup_visible_"+n.id),p.addClass("popup_content_visible")},20),p.css({visibility:"visible",opacity:1}),y.scrolllock&&(g.css("overflow","hidden"),g.height()>t.height()&&g.css("margin-right",c+u)),setTimeout(function(){s||(y.keepfocus&&e(document).on("focusin",a),y.blur&&e(document).on("click",f),y.escape&&e(document).on("keydown",l)),s?o=!0:s=!0},0),p.data("popup-visible",!0),v.reposition(n,h),y.background&&(w.css({visibility:"visible",opacity:y.opacity}),setTimeout(function(){w.css({opacity:y.opacity})},0)),d=document.activeElement,y.keepfocus&&(p.attr("tabindex",-1),setTimeout(function(){y.focuselement?e(y.focuselement).focus():p.focus()},y.focusdelay),a=function(e){var t=document.getElementById(n.id);t.contains(e.target)||(e.stopPropagation(),t.focus())});if(y.autozindex){var E=document.getElementsByTagName("*"),S=E.length,x=0;for(var T=0;T<S;T++){var N=e(E[T]).css("z-index");N!=="auto"&&(N=parseInt(N),x<N&&(x=N))}r[n.id]=x,r[n.id]>0&&b.css({zIndex:r[n.id]+2}),y.background&&r[n.id]>0&&e("#"+n.id+"_background").css({zIndex:r[n.id]+1})}y.blur&&(f=function(t){e(t.target).parents().andSelf().is("#"+n.id)||v.hide(n)}),y.escape&&(l=function(e){e.keyCode==27&&p.data("popup-visible")&&v.hide(n)}),e(y.pagecontainer).attr("aria-hidden",!0),p.attr("aria-hidden",!1),b.one("transitionend",function(){m(n,h,y.opentransitionend)}),m(n,h,y.onopen)},hide:function(t){var n=e("body"),r=e(t),u=r.data("popupoptions"),h=e("#"+t.id+"_wrapper"),p=e("#"+t.id+"_background");r.data("popup-visible",!1),o?(e("html").removeClass("popup_visible_"+t.id),o=!1):(e("html").removeClass("popup_visible").removeClass("popup_visible_"+t.id),s=!1),r.removeClass("popup_content_visible"),u.scrolllock&&setTimeout(function(){n.css({overflow:"visible","margin-right":c})},10),u.blur&&e(document).off("click",f),u.keepfocus&&(e(document).off("focusin",a),setTimeout(function(){e(d).is(":visible")&&d.focus()},0)),u.escape&&e(document).off("keydown",l),h.css({visibility:"hidden",opacity:0}),r.css({visibility:"hidden",opacity:0}),u.background&&p.css({visibility:"hidden",opacity:0}),r.one("transitionend",function(e){r.data("popup-visible")||(u.detach?r.hide().detach():h.hide()),u.notransitiondetach||m(t,i[t.id],u.closetransitionend)}),u.notransitiondetach&&(u.detach?r.hide().detach():h.hide()),e(u.pagecontainer).attr("aria-hidden",!1),r.attr("aria-hidden",!0),m(t,i[t.id],u.onclose)},toggle:function(e,t){$el.data("popup-visible")?v.hide(e):setTimeout(function(){v.show(e,t)},0)},reposition:function(t,n){var r=e(t),i=r.data("popupoptions"),s=e("#"+t.id+"_wrapper"),o=e("#"+t.id+"_background");n=n||0;if(i.type=="tooltip"){s.css({position:"absolute"});var u=i.openelement?i.openelement:"."+t.id+h,a=e(u+'[data-popup-ordinal="'+n+'"]'),f=a.offset();i.horizontal=="right"?s.css("left",f.left+a.outerWidth()+i.offsetleft):i.horizontal=="leftedge"?s.css("left",f.left+a.outerWidth()-a.outerWidth()+i.offsetleft):i.horizontal=="left"?s.css("right",e(window).width()-f.left-i.offsetleft):i.horizontal=="rightedge"?s.css("right",e(window).width()-f.left-a.outerWidth()-i.offsetleft):s.css("left",f.left+a.outerWidth()/2-r.outerWidth()/2-parseFloat(r.css("marginLeft"))+i.offsetleft),i.vertical=="bottom"?s.css("top",f.top+a.outerHeight()+i.offsettop):i.vertical=="bottomedge"?s.css("top",f.top+a.outerHeight()-r.outerHeight()+i.offsettop):i.vertical=="top"?s.css("bottom",e(window).height()-f.top-i.offsettop):i.vertical=="topedge"?s.css("bottom",e(window).height()-f.top-r.outerHeight()-i.offsettop):s.css("top",f.top+a.outerHeight()/2-r.outerHeight()/2-parseFloat(r.css("marginTop"))+i.offsettop)}else i.type=="overlay"&&(i.horizontal?s.css("text-align",i.horizontal):s.css("text-align","center"),i.vertical?r.css("vertical-align",i.vertical):r.css("vertical-align","middle"))}},m=function(t,r,i){var s=n.openelement?n.openelement:"."+t.id+h,o=e(s+'[data-popup-ordinal="'+r+'"]');typeof i=="function"&&i(o)};e.fn.popup=function(t){return this.each(function(){$el=e(this);if(typeof t=="object"){var r=e.extend({},e.fn.popup.defaults,t);$el.data("popupoptions",r),n=$el.data("popupoptions"),v._init(this)}else typeof t=="string"?($el.data("popupoptions")||($el.data("popupoptions",e.fn.popup.defaults),n=$el.data("popupoptions")),v[t].call(this,this)):($el.data("popupoptions")||($el.data("popupoptions",e.fn.popup.defaults),n=$el.data("popupoptions")),v._init(this))})},e.fn.popup.defaults={type:"overlay",autoopen:!1,background:!0,color:"black",opacity:"0.5",horizontal:"center",vertical:"middle",offsettop:0,offsetleft:0,escape:!0,blur:!0,setzindex:!0,autozindex:!1,scrolllock:!1,keepfocus:!0,focuselement:null,focusdelay:50,outline:!1,pagecontainer:null,detach:!1,openelement:null,closeelement:null,transition:null,notransitiondetach:!1,beforeopen:function(){},onclose:function(){},onopen:function(){},opentransitionend:function(){},closetransitionend:function(){}}})(jQuery);