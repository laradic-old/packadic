(function(e){typeof exports=="object"&&typeof module=="object"?e(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)})(function(e){e.defineMode("stex",function(){function e(e,t){e.cmdState.push(t)}function t(e){return e.cmdState.length>0?e.cmdState[e.cmdState.length-1]:null}function n(e){var t=e.cmdState.pop();t&&t.closeBracket()}function r(e){var t=e.cmdState;for(var n=t.length-1;n>=0;n--){var r=t[n];if(r.name=="DEFAULT")continue;return r}return{styleIdentifier:function(){return null}}}function i(e,t,n){return function(){this.name=e,this.bracketNo=0,this.style=t,this.styles=n,this.argument=null,this.styleIdentifier=function(){return this.styles[this.bracketNo-1]||null},this.openBracket=function(){return this.bracketNo++,"bracket"},this.closeBracket=function(){}}}function o(e,t){e.f=t}function u(n,i){var u;if(n.match(/^\\[a-zA-Z@]+/)){var l=n.current().slice(1);return u=s[l]||s.DEFAULT,u=new u,e(i,u),o(i,f),u.style}if(n.match(/^\\[$&%#{}_]/))return"tag";if(n.match(/^\\[,;!\/\\]/))return"tag";if(n.match("\\["))return o(i,function(e,t){return a(e,t,"\\]")}),"keyword";if(n.match("$$"))return o(i,function(e,t){return a(e,t,"$$")}),"keyword";if(n.match("$"))return o(i,function(e,t){return a(e,t,"$")}),"keyword";var c=n.next();if(c=="%")return n.skipToEnd(),"comment";if(c=="}"||c=="]")return u=t(i),u?(u.closeBracket(c),o(i,f),"bracket"):"error";return c=="{"||c=="["?(u=s.DEFAULT,u=new u,e(i,u),"bracket"):/\d/.test(c)?(n.eatWhile(/[\w.%]/),"atom"):(n.eatWhile(/[\w\-_]/),u=r(i),u.name=="begin"&&(u.argument=n.current()),u.styleIdentifier())}function a(e,t,n){if(e.eatSpace())return null;if(e.match(n))return o(t,u),"keyword";if(e.match(/^\\[a-zA-Z@]+/))return"tag";if(e.match(/^[a-zA-Z]+/))return"variable-2";if(e.match(/^\\[$&%#{}_]/))return"tag";if(e.match(/^\\[,;!\/]/))return"tag";if(e.match(/^[\^_&]/))return"tag";if(e.match(/^[+\-<>|=,\/@!*:;'"`~#?]/))return null;if(e.match(/^(\d+\.\d*|\d*\.\d+|\d+)/))return"number";var r=e.next();return r=="{"||r=="}"||r=="["||r=="]"||r=="("||r==")"?"bracket":r=="%"?(e.skipToEnd(),"comment"):"error"}function f(e,r){var i=e.peek(),s;return i=="{"||i=="["?(s=t(r),s.openBracket(i),e.eat(i),o(r,u),"bracket"):/[ \t\r]/.test(i)?(e.eat(i),null):(o(r,u),n(r),u(e,r))}var s={};return s.importmodule=i("importmodule","tag",["string","builtin"]),s.documentclass=i("documentclass","tag",["","atom"]),s.usepackage=i("usepackage","tag",["atom"]),s.begin=i("begin","tag",["atom"]),s.end=i("end","tag",["atom"]),s.DEFAULT=function(){this.name="DEFAULT",this.style="tag",this.styleIdentifier=this.openBracket=this.closeBracket=function(){}},{startState:function(){return{cmdState:[],f:u}},copyState:function(e){return{cmdState:e.cmdState.slice(),f:e.f}},token:function(e,t){return t.f(e,t)},blankLine:function(e){e.f=u,e.cmdState.length=0},lineComment:"%"}}),e.defineMIME("text/x-stex","stex"),e.defineMIME("text/x-latex","stex")});