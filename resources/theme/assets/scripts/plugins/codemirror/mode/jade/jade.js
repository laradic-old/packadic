(function(e){typeof exports=="object"&&typeof module=="object"?e(require("../../lib/codemirror"),require("../javascript/javascript"),require("../css/css"),require("../htmlmixed/htmlmixed")):typeof define=="function"&&define.amd?define(["../../lib/codemirror","../javascript/javascript","../css/css","../htmlmixed/htmlmixed"],e):e(CodeMirror)})(function(e){e.defineMode("jade",function(t){function a(){this.javaScriptLine=!1,this.javaScriptLineExcludesColon=!1,this.javaScriptArguments=!1,this.javaScriptArgumentsDepth=0,this.isInterpolating=!1,this.interpolationNesting=0,this.jsState=u.startState(),this.restOfLine="",this.isIncludeFiltered=!1,this.isEach=!1,this.lastTag="",this.scriptType="",this.isAttrs=!1,this.attrsNest=[],this.inAttributeName=!0,this.attributeIsType=!1,this.attrValue="",this.indentOf=Infinity,this.indentToken="",this.innerMode=null,this.innerState=null,this.innerModeForLine=!1}function f(e,t){e.sol()&&(t.javaScriptLine=!1,t.javaScriptLineExcludesColon=!1);if(t.javaScriptLine){if(t.javaScriptLineExcludesColon&&e.peek()===":"){t.javaScriptLine=!1,t.javaScriptLineExcludesColon=!1;return}var n=u.token(e,t.jsState);return e.eol()&&(t.javaScriptLine=!1),n||!0}}function l(e,t){if(t.javaScriptArguments){if(t.javaScriptArgumentsDepth===0&&e.peek()!=="("){t.javaScriptArguments=!1;return}e.peek()==="("?t.javaScriptArgumentsDepth++:e.peek()===")"&&t.javaScriptArgumentsDepth--;if(t.javaScriptArgumentsDepth===0){t.javaScriptArguments=!1;return}var n=u.token(e,t.jsState);return n||!0}}function c(e){if(e.match(/^yield\b/))return"keyword"}function h(e){if(e.match(/^(?:doctype) *([^\n]+)?/))return r}function p(e,t){if(e.match("#{"))return t.isInterpolating=!0,t.interpolationNesting=0,"punctuation"}function d(e,t){if(t.isInterpolating){if(e.peek()==="}"){t.interpolationNesting--;if(t.interpolationNesting<0)return e.next(),t.isInterpolating=!1,"puncutation"}else e.peek()==="{"&&t.interpolationNesting++;return u.token(e,t.jsState)||!0}}function v(e,t){if(e.match(/^case\b/))return t.javaScriptLine=!0,n}function m(e,t){if(e.match(/^when\b/))return t.javaScriptLine=!0,t.javaScriptLineExcludesColon=!0,n}function g(e){if(e.match(/^default\b/))return n}function y(e,t){if(e.match(/^extends?\b/))return t.restOfLine="string",n}function b(e,t){if(e.match(/^append\b/))return t.restOfLine="variable",n}function w(e,t){if(e.match(/^prepend\b/))return t.restOfLine="variable",n}function E(e,t){if(e.match(/^block\b *(?:(prepend|append)\b)?/))return t.restOfLine="variable",n}function S(e,t){if(e.match(/^include\b/))return t.restOfLine="string",n}function x(e,t){if(e.match(/^include:([a-zA-Z0-9\-]+)/,!1)&&e.match("include"))return t.isIncludeFiltered=!0,n}function T(e,t){if(t.isIncludeFiltered){var n=D(e,t);return t.isIncludeFiltered=!1,t.restOfLine="string",n}}function N(e,t){if(e.match(/^mixin\b/))return t.javaScriptLine=!0,n}function C(e,t){if(e.match(/^\+([-\w]+)/))return e.match(/^\( *[-\w]+ *=/,!1)||(t.javaScriptArguments=!0,t.javaScriptArgumentsDepth=0),"variable";if(e.match(/^\+#{/,!1))return e.next(),t.mixinCallAfter=!0,p(e,t)}function k(e,t){if(t.mixinCallAfter)return t.mixinCallAfter=!1,e.match(/^\( *[-\w]+ *=/,!1)||(t.javaScriptArguments=!0,t.javaScriptArgumentsDepth=0),!0}function L(e,t){if(e.match(/^(if|unless|else if|else)\b/))return t.javaScriptLine=!0,n}function A(e,t){if(e.match(/^(- *)?(each|for)\b/))return t.isEach=!0,n}function O(e,t){if(t.isEach){if(e.match(/^ in\b/))return t.javaScriptLine=!0,t.isEach=!1,n;if(e.sol()||e.eol())t.isEach=!1;else if(e.next()){while(!e.match(/^ in\b/,!1)&&e.next());return"variable"}}}function M(e,t){if(e.match(/^while\b/))return t.javaScriptLine=!0,n}function _(e,t){var n;if(n=e.match(/^(\w(?:[-:\w]*\w)?)\/?/))return t.lastTag=n[1].toLowerCase(),t.lastTag==="script"&&(t.scriptType="application/javascript"),"tag"}function D(n,r){if(n.match(/^:([\w\-]+)/)){var i;return t&&t.innerModes&&(i=t.innerModes(n.current().substring(1))),i||(i=n.current().substring(1)),typeof i=="string"&&(i=e.getMode(t,i)),V(n,r,i),"atom"}}function P(e,t){if(e.match(/^(!?=|-)/))return t.javaScriptLine=!0,"punctuation"}function H(e){if(e.match(/^#([\w-]+)/))return i}function B(e){if(e.match(/^\.([\w-]+)/))return s}function j(e,t){if(e.peek()=="(")return e.next(),t.isAttrs=!0,t.attrsNest=[],t.inAttributeName=!0,t.attrValue="",t.attributeIsType=!1,"punctuation"}function F(e,t){if(t.isAttrs){o[e.peek()]&&t.attrsNest.push(o[e.peek()]);if(t.attrsNest[t.attrsNest.length-1]===e.peek())t.attrsNest.pop();else if(e.eat(")"))return t.isAttrs=!1,"punctuation";if(t.inAttributeName&&e.match(/^[^=,\)!]+/)){if(e.peek()==="="||e.peek()==="!")t.inAttributeName=!1,t.jsState=u.startState(),t.lastTag==="script"&&e.current().trim().toLowerCase()==="type"?t.attributeIsType=!0:t.attributeIsType=!1;return"attribute"}var n=u.token(e,t.jsState);t.attributeIsType&&n==="string"&&(t.scriptType=e.current().toString());if(t.attrsNest.length===0&&(n==="string"||n==="variable"||n==="keyword"))try{return Function("","var x "+t.attrValue.replace(/,\s*$/,"").replace(/^!/,"")),t.inAttributeName=!0,t.attrValue="",e.backUp(e.current().length),F(e,t)}catch(r){}return t.attrValue+=e.current(),n||!0}}function I(e,t){if(e.match(/^&attributes\b/))return t.javaScriptArguments=!0,t.javaScriptArgumentsDepth=0,"keyword"}function q(e){if(e.sol()&&e.eatSpace())return"indent"}function R(e,t){if(e.match(/^ *\/\/(-)?([^\n]*)/))return t.indentOf=e.indentation(),t.indentToken="comment","comment"}function U(e){if(e.match(/^: */))return"colon"}function z(e,t){if(e.match(/^(?:\| ?| )([^\n]+)/))return"string";if(e.match(/^(<[^\n]*)/,!1))return V(e,t,"htmlmixed"),t.innerModeForLine=!0,$(e,t,!0)}function W(e,t){if(e.eat(".")){var n=null;return t.lastTag==="script"&&t.scriptType.toLowerCase().indexOf("javascript")!=-1?n=t.scriptType.toLowerCase().replace(/"|'/g,""):t.lastTag==="style"&&(n="css"),V(e,t,n),"dot"}}function X(e){return e.next(),null}function V(n,r,i){i=e.mimeModes[i]||i,i=t.innerModes?t.innerModes(i)||i:i,i=e.mimeModes[i]||i,i=e.getMode(t,i),r.indentOf=n.indentation(),i&&i.name!=="null"?r.innerMode=i:r.indentToken="string"}function $(e,t,n){if(e.indentation()>t.indentOf||t.innerModeForLine&&!e.sol()||n)return t.innerMode?(t.innerState||(t.innerState=t.innerMode.startState?t.innerMode.startState(e.indentation()):{}),e.hideFirstChars(t.indentOf+2,function(){return t.innerMode.token(e,t.innerState)||!0})):(e.skipToEnd(),t.indentToken);e.sol()&&(t.indentOf=Infinity,t.indentToken=null,t.innerMode=null,t.innerState=null)}function J(e,t){e.sol()&&(t.restOfLine="");if(t.restOfLine){e.skipToEnd();var n=t.restOfLine;return t.restOfLine="",n}}function K(){return new a}function Q(e){return e.copy()}function G(e,t){var n=$(e,t)||J(e,t)||d(e,t)||T(e,t)||O(e,t)||F(e,t)||f(e,t)||l(e,t)||k(e,t)||c(e,t)||h(e,t)||p(e,t)||v(e,t)||m(e,t)||g(e,t)||y(e,t)||b(e,t)||w(e,t)||E(e,t)||S(e,t)||x(e,t)||N(e,t)||C(e,t)||L(e,t)||A(e,t)||M(e,t)||_(e,t)||D(e,t)||P(e,t)||H(e,t)||B(e,t)||j(e,t)||I(e,t)||q(e,t)||z(e,t)||R(e,t)||U(e,t)||W(e,t)||X(e,t);return n===!0?null:n}var n="keyword",r="meta",i="builtin",s="qualifier",o={"{":"}","(":")","[":"]"},u=e.getMode(t,"javascript");return a.prototype.copy=function(){var t=new a;return t.javaScriptLine=this.javaScriptLine,t.javaScriptLineExcludesColon=this.javaScriptLineExcludesColon,t.javaScriptArguments=this.javaScriptArguments,t.javaScriptArgumentsDepth=this.javaScriptArgumentsDepth,t.isInterpolating=this.isInterpolating,t.interpolationNesting=this.intpolationNesting,t.jsState=e.copyState(u,this.jsState),t.innerMode=this.innerMode,this.innerMode&&this.innerState&&(t.innerState=e.copyState(this.innerMode,this.innerState)),t.restOfLine=this.restOfLine,t.isIncludeFiltered=this.isIncludeFiltered,t.isEach=this.isEach,t.lastTag=this.lastTag,t.scriptType=this.scriptType,t.isAttrs=this.isAttrs,t.attrsNest=this.attrsNest.slice(),t.inAttributeName=this.inAttributeName,t.attributeIsType=this.attributeIsType,t.attrValue=this.attrValue,t.indentOf=this.indentOf,t.indentToken=this.indentToken,t.innerModeForLine=this.innerModeForLine,t},{startState:K,copyState:Q,token:G}}),e.defineMIME("text/x-jade","jade")});