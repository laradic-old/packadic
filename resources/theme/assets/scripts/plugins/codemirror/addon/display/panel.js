(function(e){typeof exports=="object"&&typeof module=="object"?e(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)})(function(e){function t(e,t,n,r){this.cm=e,this.node=t,this.options=n,this.height=r,this.cleared=!1}function n(e){var t=e.getWrapperElement(),n=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,r=parseInt(n.height),i=e.state.panels={setHeight:t.style.height,heightLeft:r,panels:0,wrapper:document.createElement("div")};t.parentNode.insertBefore(i.wrapper,t);var s=e.hasFocus();i.wrapper.appendChild(t),s&&e.focus(),e._setSize=e.setSize,r!=null&&(e.setSize=function(t,n){if(n==null)return this._setSize(t,n);i.setHeight=n;if(typeof n!="number"){var s=/^(\d+\.?\d*)px$/.exec(n);s?n=Number(s[1]):(i.wrapper.style.height=n,n=i.wrapper.offsetHeight,i.wrapper.style.height="")}e._setSize(t,i.heightLeft+=n-r),r=n})}function r(e){var t=e.state.panels;e.state.panels=null;var n=e.getWrapperElement();t.wrapper.parentNode.replaceChild(n,t.wrapper),n.style.height=t.setHeight,e.setSize=e._setSize,e.setSize()}e.defineExtension("addPanel",function(e,r){this.state.panels||n(this);var i=this.state.panels;r&&r.position=="bottom"?i.wrapper.appendChild(e):i.wrapper.insertBefore(e,i.wrapper.firstChild);var s=r&&r.height||e.offsetHeight;return this._setSize(null,i.heightLeft-=s),i.panels++,new t(this,e,r,s)}),t.prototype.clear=function(){if(this.cleared)return;this.cleared=!0;var e=this.cm.state.panels;this.cm._setSize(null,e.heightLeft+=this.height),e.wrapper.removeChild(this.node),--e.panels==0&&r(this.cm)},t.prototype.changed=function(e){var t=e==null?this.node.offsetHeight:e,n=this.cm.state.panels;this.cm._setSize(null,n.height+=t-this.height),this.height=t}});