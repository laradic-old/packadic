module("Events",{setup:function(){this.input=$('<input type="text" value="31-03-2011">').appendTo("#qunit-fixture").datepicker({format:"dd-mm-yyyy"}).focus(),this.dp=this.input.data("datepicker"),this.picker=this.dp.picker},teardown:function(){this.picker.remove()}}),test("Selecting a year from decade view triggers changeYear",function(){var e,t=0;this.input.on("changeYear",function(){t++}),equal(this.dp.viewMode,0),e=this.picker.find(".datepicker-days thead th.datepicker-switch"),ok(e.is(":visible"),"View switcher is visible"),e.click(),ok(this.picker.find(".datepicker-months").is(":visible"),"Month picker is visible"),equal(this.dp.viewMode,1),datesEqual(this.dp.viewDate,UTCDate(2011,2,31)),datesEqual(this.dp.dates[0],UTCDate(2011,2,31)),e=this.picker.find(".datepicker-months thead th.datepicker-switch"),ok(e.is(":visible"),"View switcher is visible"),e.click(),ok(this.picker.find(".datepicker-years").is(":visible"),"Year picker is visible"),equal(this.dp.viewMode,2),datesEqual(this.dp.viewDate,UTCDate(2011,2,31)),datesEqual(this.dp.dates[0],UTCDate(2011,2,31)),e=this.picker.find(".datepicker-years tbody span:contains(2010)"),e.click(),equal(this.dp.viewMode,1),datesEqual(this.dp.viewDate,UTCDate(2010,2,1)),datesEqual(this.dp.dates[0],UTCDate(2011,2,31)),equal(t,1)}),test("Navigating forward/backward from month view triggers changeYear",function(){var e,t=0;this.input.on("changeYear",function(){t++}),equal(this.dp.viewMode,0),e=this.picker.find(".datepicker-days thead th.datepicker-switch"),ok(e.is(":visible"),"View switcher is visible"),e.click(),ok(this.picker.find(".datepicker-months").is(":visible"),"Month picker is visible"),equal(this.dp.viewMode,1),e=this.picker.find(".datepicker-months thead th.prev"),ok(e.is(":visible"),"Prev switcher is visible"),e.click(),ok(this.picker.find(".datepicker-months").is(":visible"),"Month picker is visible"),equal(t,1),e=this.picker.find(".datepicker-months thead th.next"),ok(e.is(":visible"),"Next switcher is visible"),e.click(),ok(this.picker.find(".datepicker-months").is(":visible"),"Month picker is visible"),equal(t,2)}),test("Selecting a month from year view triggers changeMonth",function(){var e,t=0;this.input.on("changeMonth",function(){t++}),equal(this.dp.viewMode,0),e=this.picker.find(".datepicker-days thead th.datepicker-switch"),ok(e.is(":visible"),"View switcher is visible"),e.click(),ok(this.picker.find(".datepicker-months").is(":visible"),"Month picker is visible"),equal(this.dp.viewMode,1),datesEqual(this.dp.viewDate,UTCDate(2011,2,31)),datesEqual(this.dp.dates[0],UTCDate(2011,2,31)),e=this.picker.find(".datepicker-months tbody span:contains(Apr)"),e.click(),equal(this.dp.viewMode,0),datesEqual(this.dp.viewDate,UTCDate(2011,3,1)),datesEqual(this.dp.dates[0],UTCDate(2011,2,31)),equal(t,1)}),test("Navigating forward/backward from month view triggers changeMonth",function(){var e,t=0;this.input.on("changeMonth",function(){t++}),equal(this.dp.viewMode,0),e=this.picker.find(".datepicker-days thead th.prev"),ok(e.is(":visible"),"Prev switcher is visible"),e.click(),ok(this.picker.find(".datepicker-days").is(":visible"),"Day picker is visible"),equal(t,1),e=this.picker.find(".datepicker-days thead th.next"),ok(e.is(":visible"),"Next switcher is visible"),e.click(),ok(this.picker.find(".datepicker-days").is(":visible"),"Day picker is visible"),equal(t,2)}),test("format() returns a formatted date string",function(){var e,t,n;this.input.on("changeDate",function(e){try{n=e.format()}catch(e){t=e}}),equal(this.dp.viewMode,0),e=this.picker.find(".datepicker-days tbody td:nth(15)"),e.click(),datesEqual(this.dp.viewDate,UTCDate(2011,2,14)),datesEqual(this.dp.dates[0],UTCDate(2011,2,14)),equal(t,undefined),equal(n,"14-03-2011")}),test("format(altformat) returns a formatted date string",function(){var e,t,n;this.input.on("changeDate",function(e){try{n=e.format("m/d/yy")}catch(e){t=e}}),equal(this.dp.viewMode,0),e=this.picker.find(".datepicker-days tbody td:nth(15)"),e.click(),datesEqual(this.dp.viewDate,UTCDate(2011,2,14)),datesEqual(this.dp.dates[0],UTCDate(2011,2,14)),equal(t,undefined),equal(n,"3/14/11")}),test("format(ix) returns a formatted date string of the ix'th date selected",function(){var e,t,n;this.dp._process_options({multidate:!0}),this.input.on("changeDate",function(e){try{n=e.format(2)}catch(e){t=e}}),e=this.picker.find(".datepicker-days tbody td:nth(7)"),equal(e.text(),"6"),e.click(),e=this.picker.find(".datepicker-days tbody td:nth(15)"),equal(e.text(),"14"),e.click(),equal(this.dp.dates.length,3),equal(t,undefined),equal(n,"14-03-2011")}),test("format(ix, altformat) returns a formatted date string",function(){var e,t,n;this.dp._process_options({multidate:!0}),this.input.on("changeDate",function(e){try{n=e.format(2,"m/d/yy")}catch(e){t=e}}),e=this.picker.find(".datepicker-days tbody td:nth(7)"),equal(e.text(),"6"),e.click(),e=this.picker.find(".datepicker-days tbody td:nth(15)"),equal(e.text(),"14"),e.click(),equal(this.dp.dates.length,3),equal(t,undefined),equal(n,"3/14/11")}),test("Clear button: triggers change and changeDate events",function(){this.input=$('<input type="text" value="31-03-2011">').appendTo("#qunit-fixture").datepicker({format:"dd-mm-yyyy",clearBtn:!0}).focus(),this.dp=this.input.data("datepicker"),this.picker=this.dp.picker;var e,t=0,n=0;this.input.on({changeDate:function(){n++},change:function(){t++}}),this.input.focus(),ok(this.picker.find(".datepicker-days").is(":visible"),"Days view visible"),ok(this.picker.find(".datepicker-days tfoot .clear").is(":visible"),"Clear button visible"),e=this.picker.find(".datepicker-days tfoot .clear"),e.click(),equal(t,1),equal(n,1)}),test("setDate: triggers change and changeDate events",function(){this.input=$('<input type="text" value="31-03-2011">').appendTo("#qunit-fixture").datepicker({format:"dd-mm-yyyy"}).focus(),this.dp=this.input.data("datepicker"),this.picker=this.dp.picker;var e,t=0,n=0;this.input.on({changeDate:function(){n++},change:function(){t++}}),this.input.focus(),ok(this.picker.find(".datepicker-days").is(":visible"),"Days view visible"),this.dp.setDate(new Date(2011,2,5)),equal(t,2),equal(n,1)});