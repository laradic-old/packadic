(function(e){typeof define!="undefined"&&define.amd?define([],e):typeof module!="undefined"&&module.exports?module.exports=e():window.scrollMonitor=e()})(function(){function g(){t.viewportTop=e(),t.viewportBottom=t.viewportTop+t.viewportHeight,t.documentHeight=p();if(t.documentHeight!==d){m=n.length;while(m--)n[m].recalculateLocation();d=t.documentHeight}}function y(){t.viewportHeight=h(),g(),S()}function w(){clearTimeout(b),b=setTimeout(y,100)}function S(){E=n.length;while(E--)n[E].update();E=n.length;while(E--)n[E].triggerCallbacks()}function x(e,n){function S(e){if(e.length===0)return;w=e.length;while(w--)E=e[w],E.callback.call(h,v),E.isOne&&e.splice(w,1)}var h=this;this.watchItem=e,n?n===+n?this.offsets={top:n,bottom:n}:this.offsets={top:n.top||c.top,bottom:n.bottom||c.bottom}:this.offsets=c,this.callbacks={};for(var p=0,d=l.length;p<d;p++)h.callbacks[l[p]]=[];this.locked=!1;var m,g,y,b,w,E;this.triggerCallbacks=function(){this.isInViewport&&!m&&S(this.callbacks[i]),this.isFullyInViewport&&!g&&S(this.callbacks[s]),this.isAboveViewport!==y&&this.isBelowViewport!==b&&(S(this.callbacks[r]),!g&&!this.isFullyInViewport&&(S(this.callbacks[s]),S(this.callbacks[u])),!m&&!this.isInViewport&&(S(this.callbacks[i]),S(this.callbacks[o]))),!this.isFullyInViewport&&g&&S(this.callbacks[u]),!this.isInViewport&&m&&S(this.callbacks[o]),this.isInViewport!==m&&S(this.callbacks[r]);switch(!0){case m!==this.isInViewport:case g!==this.isFullyInViewport:case y!==this.isAboveViewport:case b!==this.isBelowViewport:S(this.callbacks[f])}m=this.isInViewport,g=this.isFullyInViewport,y=this.isAboveViewport,b=this.isBelowViewport},this.recalculateLocation=function(){if(this.locked)return;var e=this.top,n=this.bottom;if(this.watchItem.nodeName){var r=this.watchItem.style.display;r==="none"&&(this.watchItem.style.display="");var i=this.watchItem.getBoundingClientRect();this.top=i.top+t.viewportTop,this.bottom=i.bottom+t.viewportTop,r==="none"&&(this.watchItem.style.display=r)}else this.watchItem===+this.watchItem?this.watchItem>0?this.top=this.bottom=this.watchItem:this.top=this.bottom=t.documentHeight-this.watchItem:(this.top=this.watchItem.top,this.bottom=this.watchItem.bottom);this.top-=this.offsets.top,this.bottom+=this.offsets.bottom,this.height=this.bottom-this.top,(e!==undefined||n!==undefined)&&(this.top!==e||this.bottom!==n)&&S(this.callbacks[a])},this.recalculateLocation(),this.update(),m=this.isInViewport,g=this.isFullyInViewport,y=this.isAboveViewport,b=this.isBelowViewport}function A(e){v=e,g(),S()}var e=function(){return window.pageYOffset||document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop},t={},n=[],r="visibilityChange",i="enterViewport",s="fullyEnterViewport",o="exitViewport",u="partiallyExitViewport",a="locationChange",f="stateChange",l=[r,i,s,o,u,a,f],c={top:0,bottom:0},h=function(){return window.innerHeight||document.documentElement.clientHeight},p=function(){return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.documentElement.clientHeight)};t.viewportTop=null,t.viewportBottom=null,t.documentHeight=null,t.viewportHeight=h();var d,v,m,b,E;x.prototype={on:function(e,t,n){switch(!0){case e===r&&!this.isInViewport&&this.isAboveViewport:case e===i&&this.isInViewport:case e===s&&this.isFullyInViewport:case e===o&&this.isAboveViewport&&!this.isInViewport:case e===u&&this.isAboveViewport:t.call(this,v);if(n)return}if(!this.callbacks[e])throw new Error("Tried to add a scroll monitor listener of type "+e+". Your options are: "+l.join(", "));this.callbacks[e].push({callback:t,isOne:n||!1})},off:function(e,t){if(!this.callbacks[e])throw new Error("Tried to remove a scroll monitor listener of type "+e+". Your options are: "+l.join(", "));for(var n=0,r;r=this.callbacks[e][n];n++)if(r.callback===t){this.callbacks[e].splice(n,1);break}},one:function(e,t){this.on(e,t,!0)},recalculateSize:function(){this.height=this.watchItem.offsetHeight+this.offsets.top+this.offsets.bottom,this.bottom=this.top+this.height},update:function(){this.isAboveViewport=this.top<t.viewportTop,this.isBelowViewport=this.bottom>t.viewportBottom,this.isInViewport=this.top<=t.viewportBottom&&this.bottom>=t.viewportTop,this.isFullyInViewport=this.top>=t.viewportTop&&this.bottom<=t.viewportBottom||this.isAboveViewport&&this.isBelowViewport},destroy:function(){var e=n.indexOf(this),t=this;n.splice(e,1);for(var r=0,i=l.length;r<i;r++)t.callbacks[l[r]].length=0},lock:function(){this.locked=!0},unlock:function(){this.locked=!1}};var T=function(e){return function(t,n){this.on.call(this,e,t,n)}};for(var N=0,C=l.length;N<C;N++){var k=l[N];x.prototype[k]=T(k)}try{g()}catch(L){try{window.$(g)}catch(L){throw new Error("If you must put scrollMonitor in the <head>, you must use jQuery.")}}return window.addEventListener?(window.addEventListener("scroll",A),window.addEventListener("resize",w)):(window.attachEvent("onscroll",A),window.attachEvent("onresize",w)),t.beget=t.create=function(e,t){typeof e=="string"?e=document.querySelector(e):e&&e.length>0&&(e=e[0]);var r=new x(e,t);return n.push(r),r.update(),r},t.update=function(){v=null,g(),S()},t.recalculateLocations=function(){t.documentHeight=0,t.update()},t});