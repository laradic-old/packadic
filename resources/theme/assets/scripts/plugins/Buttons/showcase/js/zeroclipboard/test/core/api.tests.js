(function(e,t){var n={getHtmlBridge:function(){return document.getElementById("global-zeroclipboard-html-bridge")}},r,i;e("core/api.js unit tests - state"),t("`state` produces expected result",function(e){e.expect(8);var t=ZeroClipboard.state();e.deepEqual(Object.keys(t),["browser","flash","zeroclipboard"],"Has all expected keys"),e.strictEqual(typeof t.browser,"object",".browser is an object"),e.notStrictEqual(t.browser,null,".browser is a non-null object"),e.strictEqual(typeof t.flash,"object",".flash is an object"),e.notStrictEqual(t.flash,null,".flash is a non-null object"),e.strictEqual(typeof t.zeroclipboard,"object",".zeroclipboard is an object"),e.notStrictEqual(t.zeroclipboard,null,".zeroclipboard is a non-null object"),e.deepEqual(Object.keys(t.zeroclipboard),["version","config"],".zeroclipboard has all expected keys")}),e("core/api.js unit tests - config",{setup:function(){r=ZeroClipboard.config()},teardown:function(){_globalConfig=r}}),t("`swfPath` finds the expected default URL",function(e){e.expect(1);var t=window.location.protocol+"//"+window.location.host+"/",n=window.location.pathname.toLowerCase().indexOf("/test/"),r=window.location.pathname.slice(1,n+1),i=t+r,s=i+"src/js/core/ZeroClipboard.swf";e.strictEqual(ZeroClipboard.config("swfPath"),s)}),t("Changing `trustedDomains` works",function(e){e.expect(5);var t=window.location.host,n=t?[t]:[],r=t?[t,"otherDomain.com"]:["otherDomain.com"];e.deepEqual(ZeroClipboard.config("trustedDomains"),n),e.deepEqual(ZeroClipboard.config().trustedDomains,n);var i=ZeroClipboard.config({trustedDomains:r});e.deepEqual(i.trustedDomains,r),e.deepEqual(ZeroClipboard.config("trustedDomains"),r),e.deepEqual(ZeroClipboard.config().trustedDomains,r)}),t("Some config values are ignored if SWF is actively embedded",function(e){e.expect(2);var t=ZeroClipboard.config("swfPath"),n={swfPath:t,trustedDomains:window.location.host?[window.location.host]:[],cacheBust:!0,forceEnhancedClipboard:!1,flashLoadTimeout:3e4,autoActivate:!0,containerId:"global-zeroclipboard-html-bridge",containerClass:"global-zeroclipboard-container",swfObjectId:"global-zeroclipboard-flash-bridge",hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",bubbleEvents:!0,forceHandCursor:!1,title:null,zIndex:999999999},r={swfPath:t,trustedDomains:window.location.host?[window.location.host]:[],cacheBust:!0,forceEnhancedClipboard:!1,flashLoadTimeout:3e4,autoActivate:!0,containerId:"global-zeroclipboard-html-bridge",containerClass:"global-zeroclipboard-container",swfObjectId:"global-zeroclipboard-flash-bridge",hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",bubbleEvents:!1,forceHandCursor:!0,title:"test",zIndex:1e3},i=ZeroClipboard.config();_flashState.bridge={};var s=ZeroClipboard.config({swfPath:"/path/to/test.swf",trustedDomains:["test.domain.com"],cacheBust:!1,forceEnhancedClipboard:!0,flashLoadTimeout:15e3,autoActivate:!1,containerId:"test-id",containerClass:"test-class",swfObjectId:"test-swf",hoverClass:"test-hover",activeClass:"test-active",bubbleEvents:!1,forceHandCursor:!0,title:"test",zIndex:1e3});e.deepEqual(i,n,"Original config is as expected"),e.deepEqual(s,r,"Updated config is as expected")}),e("core/api.js unit tests - clipboard",{teardown:function(){_deleteOwnProperties(_clipData)}}),t("`setData` works",function(e){e.expect(4),e.deepEqual(_clipData,{},"`_clipData` is empty"),ZeroClipboard.setData("text/plain","zc4evar"),e.deepEqual(_clipData,{"text/plain":"zc4evar"},"`_clipData` contains expected text"),ZeroClipboard.setData("text/x-markdown","**ZeroClipboard**"),e.deepEqual(_clipData,{"text/plain":"zc4evar","text/x-markdown":"**ZeroClipboard**"},"`_clipData` contains expected text and custom format"),ZeroClipboard.setData({"text/html":"<b>Win</b>"}),e.deepEqual(_clipData,{"text/html":"<b>Win</b>"},"`_clipData` contains expected HTML and cleared out old data because an object was passed in")}),t("`clearData` works",function(e){e.expect(4),e.deepEqual(_clipData,{},"`_clipData` is empty"),_clipData["text/plain"]="zc4evar",_clipData["text/html"]="<b>Win</b>",_clipData["text/x-markdown"]="**ZeroClipboard**",e.deepEqual(_clipData,{"text/plain":"zc4evar","text/html":"<b>Win</b>","text/x-markdown":"**ZeroClipboard**"},"`_clipData` contains all expected data"),ZeroClipboard.clearData("text/html"),e.deepEqual(_clipData,{"text/plain":"zc4evar","text/x-markdown":"**ZeroClipboard**"},"`_clipData` had 'text/html' successfully removed"),ZeroClipboard.clearData(),e.deepEqual(_clipData,{},"`_clipData` had all data successfully removed")}),e("core/api.js unit tests - flash",{setup:function(){i=ZeroClipboard.isFlashUnusable,ZeroClipboard.isFlashUnusable=function(){return!1}},teardown:function(){ZeroClipboard.isFlashUnusable=i,ZeroClipboard.destroy()}}),t("Flash object is ready after emitting `ready`",function(e){e.expect(2),ZeroClipboard.isFlashUnusable=function(){return!1},ZeroClipboard.create(),e.strictEqual(_flashState.ready,!1),ZeroClipboard.emit("ready"),e.strictEqual(_flashState.ready,!0)}),t("Object has a title",function(e){e.expect(1);var t=document.getElementById("d_clip_button");ZeroClipboard.create(),ZeroClipboard.activate(t),e.strictEqual(n.getHtmlBridge().getAttribute("title"),"Click me to copy to clipboard."),ZeroClipboard.deactivate()}),t("Object has no title",function(e){e.expect(1);var t=document.getElementById("d_clip_button_no_title");ZeroClipboard.create(),ZeroClipboard.activate(t),e.ok(!n.getHtmlBridge().getAttribute("title")),ZeroClipboard.deactivate()}),t("Object has data-clipboard-text",function(e){e.expect(3);var t=document.getElementById("d_clip_button");ZeroClipboard.create(),ZeroClipboard.activate(t);var n=ZeroClipboard.emit("copy");e.deepEqual(_clipData,{"text/plain":"Copy me!"}),e.deepEqual(n,{text:"Copy me!"}),e.deepEqual(_clipDataFormatMap,{text:"text/plain"}),ZeroClipboard.deactivate()}),t("Object has data-clipboard-target textarea",function(e){e.expect(3);var t=document.getElementById("d_clip_button_textarea_text"),n="Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod\ntempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,\nquis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo\nconsequat. Duis aute irure dolor in reprehenderit in voluptate velit esse\ncillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non\nproident, sunt in culpa qui officia deserunt mollit anim id est laborum.";ZeroClipboard.create(),ZeroClipboard.activate(t);var r=ZeroClipboard.emit("copy");e.strictEqual(_clipData["text/plain"].replace(/\r\n/g,"\n"),n),e.strictEqual(r.text.replace(/\r\n/g,"\n"),n),e.deepEqual(_clipDataFormatMap,{text:"text/plain"}),ZeroClipboard.deactivate()}),t("Object has data-clipboard-target pre",function(e){e.expect(5);var t=document.getElementById("d_clip_button_pre_text"),n="Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod\ntempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,\nquis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo\nconsequat. Duis aute irure dolor in reprehenderit in voluptate velit esse\ncillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non\nproident, sunt in culpa qui officia deserunt mollit anim id est laborum.",r='<pre id="clipboard_pre">Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod\ntempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,\nquis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo\nconsequat. Duis aute irure dolor in reprehenderit in voluptate velit esse\ncillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non\nproident, sunt in culpa qui officia deserunt mollit anim id est laborum.</pre>';ZeroClipboard.create(),ZeroClipboard.activate(t);var i=ZeroClipboard.emit("copy");e.strictEqual(_clipData["text/plain"].replace(/\r\n/g,"\n"),n),e.strictEqual(_clipData["text/html"].replace(/\r\n/g,"\n").replace(/<\/?pre(?:\s+[^>]*)?>/gi,function(e){return e.toLowerCase()}),r),e.strictEqual(i.text.replace(/\r\n/g,"\n"),n),e.strictEqual(i.html.replace(/\r\n/g,"\n").replace(/<\/?pre(?:\s+[^>]*)?>/gi,function(e){return e.toLowerCase()}),r),e.deepEqual(_clipDataFormatMap,{text:"text/plain",html:"text/html"}),ZeroClipboard.deactivate()}),t("Object has data-clipboard-target input",function(e){e.expect(3);var t=document.getElementById("d_clip_button_input_text");ZeroClipboard.create(),ZeroClipboard.activate(t);var n=ZeroClipboard.emit("copy");e.deepEqual(_clipData,{"text/plain":"Clipboard Text"}),e.deepEqual(n,{text:"Clipboard Text"}),e.deepEqual(_clipDataFormatMap,{text:"text/plain"}),ZeroClipboard.deactivate()}),t("Object doesn't have data-clipboard-text",function(e){e.expect(1);var t=document.getElementById("d_clip_button_no_text");ZeroClipboard.create(),ZeroClipboard.activate(t),e.ok(!n.getHtmlBridge().getAttribute("data-clipboard-text")),ZeroClipboard.deactivate()}),t("Calculations based on borderWidth never return NaN",function(e){e.expect(4);var t=document.getElementById("d_clip_button");ZeroClipboard.create(),ZeroClipboard.activate(t),e.strictEqual(/^-?[0-9\.]+px$/.test(n.getHtmlBridge().style.top),!0),e.strictEqual(/^-?[0-9\.]+px$/.test(n.getHtmlBridge().style.left),!0),e.strictEqual(/^-?[0-9\.]+px$/.test(n.getHtmlBridge().style.width),!0),e.strictEqual(/^-?[0-9\.]+px$/.test(n.getHtmlBridge().style.height),!0)})})(QUnit.module,QUnit.test);